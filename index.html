<!doctype html>
<html>
  <head>
    <title>Ideation</title>

    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font-family: 'Varela Round', sans-serif!important; }
      #title {text-align: center;}
      .container form {position:fixed; bottom: 5px; width: 100%;}
      #messages { list-style-type: none; margin: 0; padding: 0; }
      #messages li { padding: 5px 10px; }
      #messages li:nth-child(odd) { background: #eee; }
      #countdown{position:absolute;top:40%;left:50%;font-size:100px;display:none;}
      #vote{position:absolute;top:45%;left:63%;font-size:25px;display:none; }
      #ideators{color:#f0ad4e; text-align: right; font-size: 15px;}
      #newPromptinstruction{font-size: 10px; text-align: right; padding-bottom: 1%;}
      #activityFeed{text-align: center;}
    </style>
    <link href='//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css', rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Varela+Round' rel='stylesheet' type='text/css'>
    <link rel='stylesheet' type ='text.css' href='custom.css'>

      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script>
      <script type="text/javascript" src="draw.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h3 id="title">What is the most popular tech buzz word?</h3>
            <!--         <div class ="col-lg-2">
            <a href = "index.html" ><img src = "logo.png" alt = "logo" ></a>
          </div> -->
        </div>
      </div>

        <div class ="row"> <!--Progress Bar-->
          <div class ="col-lg-6">
            <div class="progress progress-striped">
              <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
                <span class="sr-only">0% Complete</span>
              </div>
            </div>
          </div>
          <div class ="col-lg-6">
            <ul id="voted-words"></ul>
          </div>
        </div> <!--End of Progress Bar-->

      <div class = "row">
        <div class ="col-sm-9"></div>
        <div class = "col-sm-3" id="ideators"> Ideators Active() </div>
      </div>

      <div class = "row">
        <div class ="col-sm-9"></div>
        <div class = "col-sm-3" id="newPromptinstruction"> *Press F3 for new prompt </div>
      </div>

      <div class="row"> <!--Right Activity Feed-->
        <div class="col-sm-9">
            <div id="wordcloud"></div>
        </div>
        <div class="col-sm-3">
          <div class="panel panel-warning">
            <div class="panel-heading" id="activityFeed">Idea Log</div>
            <div class="panel-body">
              <ul class="list-group" id="messages"></ul>
            </div>
          </div>
        </div>
      </div> <!--End of Right Activity Feed-->

      <div class ="row">
        <form id="inputForm"> <!--Input text area -->
          <div class="col-lg-4">
                <input type="text" class="form-control" id="submit" autocomplete="off" placeholder='Type your idea here'>
          </div>
          <div class = "col-lg-1">
                <button type="submit" class="btn btn-warning">Send</button>
          </div>
        </form> <!--End of Input text area -->

        <div class = "col-lg-6">
           <!-- This place is fot the drawing canvas feature -->
        </div>
      </div>
    </div> <!--End of container-->



    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
    var socket = io();
    
    function countdown(toHighLight){
    highlighted = $("li:contains('" + toHighLight + "')");
    highlighted.css({ 'color': 'red', 'font-size': '200%' });
    $("#countdown").css('display', 'inline-block');
    $("#vote").css('display', 'inline-block');
    timer = setInterval(decrement, 1000);
    setTimeout(endVote, 6000);
    }

    function endVote() {
      clearInterval(timer);
      highlighted.css({ 'color': 'black', 'font-size': '100%' });
      $("#countdown").html("5");
      $("#countdown").css('display', 'none');
      $("#vote").css('display', 'none');
    }

    function decrement() {
      var countdown = $("#countdown");
      var nextNumber = parseInt(countdown.text()) - 1;
      $("#countdown").html(nextNumber);
    }

    // Shorthand for on submit execute the below function, adding event handler
    $('#inputForm').submit(function(){
    socket.emit('chat message', $('#submit').val());
    $('#submit').val('');
    return false;
    });
    
    socket.on('chat message', function(msg, wordcloud, messageNum){
      $('#messages').append($('<li class="list-group-item-warning">').text(msg));
      $('#wordcloud').html(wordcloud);
      if(messageNum == 1){
        progressBarTimer = setInterval(startProgressBar, 5);
      }
    });

    function startProgressBar(){
      $(".progress-bar").css("width", "+=10");
    };

    socket.on('startCountdown', function(target){
    countdown(target);
    });

    socket.on('success', function(target){
      $('#wordcloud').html(wordcloud);
      $('#messages').html("");
      clearInterval(progressBarTimer);
      $('.progress-bar').css("width", "0");
      $('ul#voted-words').append('<li>' + target + '</li>');
      console.log(target);
    });
    
    $("#messages").on("click", "li", function(event){
      socket.emit('countdown',$(event.target).text())
    });

    $(document).ready(function() {
      $("#vote").click(function(){
        socket.emit('vote');
        $("#vote").css('display', 'none');
      }); 
    });
    </script>
    <div id = "countdown"> 
        5
    </div>
    <button id="vote" class="btn btn-info" type="button">Vote Yes</button>
  </body>
</html>